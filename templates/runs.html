{% extends "_layout.html" %}

{% block title %}Runs Overview{% endblock %}

{% block content %}
<div class="container">
  <h1>Runs Overview</h1>

  <div id="runs-root"
       data-api-base="{{ api_base_url | safe }}">

    <!-- Filters -->
    <div class="runs-filters">
      <label>
        Date:
        <input type="date" id="runs-date" />
      </label>

      <label>
        Operator:
        <select id="runs-operator-filter">
          <option value="">All operators</option>
          <option value="AJ">AJ</option>
          <option value="RB">RB</option>
          <option value="EG">EG</option>
          <option value="TH">TH</option>
          <option value="BM">BM</option>
          <option value="DW">DW</option>
          <option value="JSC">JSC</option>
        </select>
      </label>

      <button id="runs-refresh">Refresh</button>
      <button id="runs-auto-assign">Auto-assign runs for this day</button>
    </div>

    <!-- Edit toggle -->
    <div class="runs-edit-controls">
      <label>
        <input type="checkbox" id="runs-edit-toggle" />
        Edit layout (drag flights between runs)
      </label>
    </div>

    <!-- Status -->
    <div id="runs-status" class="runs-status">
      Loadingâ€¦
    </div>

    <!-- Run cards overview -->
    <div id="runs-cards" class="runs-cards">
      <!-- Cards injected by JS -->
    </div>

    <!-- Unassigned flights panel -->
    <div id="unassigned-section" class="unassigned-section" style="display:none;">
      <h2>Unassigned flights</h2>
      <p id="unassigned-summary" class="unassigned-summary"></p>
      <table id="unassigned-table" class="unassigned-table">
        <thead>
          <tr>
            <th>Time</th>
            <th>Flight</th>
            <th>Dest</th>
            <th>Operator</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody>
          <!-- Rows injected by JS -->
        </tbody>
      </table>
    </div>

    <!-- Edit grid: drag & drop between runs + from unassigned -->
    <div id="runs-edit-grid" class="runs-edit-grid" style="display:none;">
      <!-- Columns injected by JS -->
    </div>

    <!-- Selected run sheet -->
    <div id="run-sheet-section" class="run-sheet-section" style="display:none;">
      <h2 id="run-sheet-title">Run sheet</h2>
      <table id="run-sheet-table" class="run-sheet-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Time</th>
            <th>Flight</th>
            <th>Dest</th>
            <th>Operator</th>
            <th>Notes</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <!-- Rows injected by JS -->
        </tbody>
      </table>
    </div>

  </div>
</div>

<script src="{{ url_for('static', filename='js/runs.js') }}"></script>
{% endblock %}
