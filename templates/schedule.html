{% extends "_layout.html" %}
{% block title %}Schedule â€” Office Manager{% endblock %}
{% block content %}
<style>
  .card { background: var(--elev); border: 1px solid var(--line); border-radius: var(--radius); padding: var(--pad); box-shadow: var(--shadow); }
  .card-header { display: flex; align-items: center; justify-content: space-between; gap: 1rem; margin-bottom: 1rem; }
  .card-header h1 { margin: 0; font-size: 1.5rem; }
  .btn-primary { background: var(--accent); color: var(--accent-ink); border: none; border-radius: 12px; padding: 0.6rem 1rem; font-weight: 600; text-decoration: none; }
  .btn-primary:hover, .btn-primary:focus { filter: brightness(1.05); }
  .schedule-table { width: 100%; border-collapse: collapse; }
  .schedule-table th, .schedule-table td { padding: 0.75rem 0.5rem; border-bottom: 1px solid var(--line); text-align: left; }
  .schedule-table th { color: var(--muted); font-weight: 600; }
  .link-small { color: var(--accent); text-decoration: none; font-size: 0.95rem; }
  .link-small:hover, .link-small:focus { text-decoration: underline; }
  .link-danger { color: var(--danger); }
  .link-disabled { color: var(--muted); font-size: 0.95rem; }
  .actions { display: flex; gap: 0.5rem; align-items: center; }
</style>

<section class="card">
  <div class="card-header">
    <h1>Flight Schedule</h1>
    {% set current_role = get_current_role() %}
    {% if current_role in ['supervisor', 'admin'] %}
      <a href="{{ url_for('flight_create') }}" class="btn-primary">+ New Flight</a>
    {% endif %}
  </div>

  <div class="table-wrapper">
    <table class="schedule-table">
      <thead>
        <tr>
          <th>Flight</th>
          <th>Airline</th>
          <th>ETA</th>
          <th>Bay</th>
          <th>Fuel (tonnes)</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for f in flights %}
        <tr>
          <td>{{ f.flight_number }}</td>
          <td>{{ f.airline }}</td>
          <td>{{ f.eta }}</td>
          <td>{{ f.bay or "-" }}</td>
          <td>{{ f.fuel_tonnes or "-" }}</td>
          <td>{{ f.status }}</td>
          {% if current_role in ['supervisor', 'admin'] %}
          <td>
            <div class="actions">
              <a href="{{ url_for('flight_edit', flight_id=f.id) }}" class="link-small">Edit</a>
              <a href="{{ url_for('flight_confirm_delete', flight_id=f.id) }}" class="link-small link-danger">Delete</a>
            </div>
          </td>
          {% else %}
          <td><span class="link-disabled">View only</span></td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
