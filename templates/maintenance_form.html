{% extends "_layout.html" %}

{% block content %}
<main class="cc-panel">
  <h1>{{ "New Maintenance Item" if mode == "new" else "Edit Maintenance Item" }}</h1>

  <form method="post" class="cc-form">
    <div class="cc-field">
      <label for="truck_id">Truck ID</label>
      <input
        type="text"
        id="truck_id"
        name="truck_id"
        value="{{ item.truck_id if item else '' }}"
        required
      />
    </div>

    <div class="cc-field">
      <label for="due_date">Due Date (YYYY-MM-DD)</label>
      <input
        type="text"
        id="due_date"
        name="due_date"
        value="{{ item.due_date if item and item.due_date else '' }}"
      />
    </div>

    <div class="cc-field">
      <label for="status">Status</label>
      {% set current_status = item.status if item else "" %}
      {% set options = ["OK", "Due", "Completed", "Out of service"] %}
      <select id="status" name="status">
        <option value="" {% if not current_status %}selected{% endif %}>— None —</option>
        {% for opt in options %}
          <option value="{{ opt }}" {% if current_status == opt %}selected{% endif %}>
            {{ opt }}
          </option>
        {% endfor %}
        {# If an existing item has a status outside the standard options, still show it #}
        {% if current_status and current_status not in options %}
          <option value="{{ current_status }}" selected>{{ current_status }}</option>
        {% endif %}
      </select>
    </div>

    <div class="cc-field">
      <label for="description">Description</label>
      <textarea id="description" name="description">{{ item.description if item else "" }}</textarea>
    </div>

    <button type="submit" class="cc-button-primary">
      {{ "Create" if mode == "new" else "Save changes" }}
    </button>
    <a href="{{ url_for('maintenance_page') }}" class="cc-button-secondary">Cancel</a>
  </form>
</main>
{% endblock %}
